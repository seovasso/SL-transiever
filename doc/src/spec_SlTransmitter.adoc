= SlTransmitter
:Date:      31.01.2017
:Revision:  0.2
:toc:       right
:icons:     font
:source-highlighter: rouge
:table-caption:     Таблица
:listing-caption:   Код
:chapter-label:     Глава
:toc-title:         Оглавление
:version-label:     Версия
:figure-caption:    Рисунок
:imagesdir:         ./../img/

[[trans-main-description]]
== Описание
Данный проект подразумевает реализацию RTL-описания на языке Verilog одноканального передатчика SL-канала.

[[sl-channel-review]]
== Описание SL-канала
SL - канал - последовательный однонаправленный канал обмена данными, разработанный для внутриплатного и межплатного обмена информацией. Обмен данными типа "точка-с-точкой". Канал состоит из двух линий: линии единиц и линии нулей. Пассивный уровень на линиях - единица. В случае передачи данных каждый разряд кодируется отрицательным импульсом на соответствующей линии. Информация передается словами произвольной разрядности младшими разрядами вперед. Предпоследний разряд - четность. Передатчик вычисляет четность таким образом, чтобы количество импульсов на линии единиц с учетом разряда четности было нечетным, а на линии нулей - четным. Приемник контролирует четность индивидуально по каждой линии. Последним импульсом является синхроимпульс, представляющий собой отрицательные импульсы по обоим линиям одновременно. Синхроимпульс означает, что передача закончена. Не допускается перекрытия информационных импульсов во время передачи.

image::SL.png[title="Временная диаграмма SL-канала", align="center"]

Типичная рабочая частота передатчика, спроектированного в синхронном стиле,
составляет от 500кГц до 1МГц. Пауза между информационными битами равна длительности
 отрицательного импульса.

[[trans-top-level-description]]
== Описание верхнего уровня

[[trans-input-signals]]
=== Входные сигналы

* rst_n - асинхронный общий сигнал сброса
* clk - сигнал тактовой частоты
* [31:0] D_in - порт для записи данных в регистры
* wr_en - После установки в 1 в выбранный портом А регистр записывается необходимое число
* addr - "0" - регистр данных, "1" - регистр конфигурации и состояния
[[trans-output-signals]]
==== Выходные сигналы

* SL0 - сигнал нулей SL канала
* SL1 - сигнал единиц SL канала
* [31:0] D_out - порт для чтения регистров

[[trans-inout-signals]]
=== Двунаправленные сигналы

Отсутствуют.


[[trans-programm-model]]
== Программная модель
Пользователю для работы доступно несколько регистров:

* Регистр конфигурации и состояния (config_r и status_r)
* Данных к отправке (txdata_r)


=== Регистр конфигурации и состояния

Регистр конфигурации и состояния состоит из двух, объединеных между собой регистров - конфигурации и состояния. Регистру конфигурации соответвуют младшие 16 разрядов, регистру состояния - старшие.

.Назначение разрядов регистра конфигурации  (config_r)
[cols="16*^", width=99%]
|===
   |0     |1 |2 |3 |4 |5  |6       |7    |8    |9     |10   |11   |12   |13   |14    |15
 6+|BC[6:0]               |IRQM  3+|FQM[9:7]          |Res* |Res* |Res* |Res* |Res*  |Res*
|===

.Описание разрядов регистра конфигурации (config_r)
. BC - bit count, количество бит в слове
. IRQM - interrupt request mode, разрешение(IRQM = 1) или запрещение(IRQM = 0) работы прерываний модуля
. FQM - frequency mode, соответствие значения FQM и во сколько раз делится частота описано в таблице ниже.

.Связь значения FQM и частоты работы передатчика
[cols="2*^", width=99%]
|===
|Значение FQM в десятичной системе     | Делитель частоты
|1                                     |2
|2                                     |4
|3                                     |8
|4                                     |16
|5                                     |32
|>5                                    |32
|===

.Назначение разрядов регистра состояния (status_r)
[cols="16*^", width=99%]
|===
|16    |17    |18   |19   |20   |21   |22   |23   |24   |25   |26   |27   |28   |29   |30   |31
|SIP   |Res*  |Res* |Res* |Res* |Res* |Res* |Res* |Res* |Res* |Res* |Res* |Res* |Res* |Res* |Res*
|===

.Описание разрядов регистра конфигурации (config_r)
. SIP - send in process, сообщение отправлется, при попытке перезаписи этого бита ничего не происходит

=== Регистр данных к отправке
txdata_r[31:0]

.Назначение разрядов регистра данных к отправке (txdata_r)
[cols="1*^", width=99%]
|===
|0 - 31
|Data
|===

Data - данные к отправке.


[[trans-state-machine]]
== Конечный автомат
image::image_SlTransmitter_SM.png[title="Конечный автомат модуля SlTransmitter", align="center"]
